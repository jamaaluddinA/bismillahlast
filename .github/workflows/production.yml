name: ğŸš€ Deploy to Production

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ›ï¸ Checkout Repository
        uses: actions/checkout@v4
      
      - name: ğŸ¯ Setup Flutter
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.38.5'
          
      - name: ğŸ“¦ Install Dependencies
        run: flutter pub get
      
      - name: ğŸ” Analyze Code
        run: flutter analyze
      
      - name: ğŸŒ Build for Production
        run: |
          flutter config --enable-web
          flutter build web --release --web-renderer canvaskit --no-wasm-dry-run
      
      - name: ğŸš€ Deploy to Netlify Production
        uses: nwtgck/actions-netlify@v2.0
        with:
          publish-dir: './build/web'
          production-deploy: true
          production-branch: main
          deploy-message: "Production Deploy: ${{ github.sha }}"
        env:
          NETLIFY_AUTH_TOKEN: ${{ secrets.NETLIFY_AUTH_TOKEN }}
          NETLIFY_SITE_ID: ${{ secrets.NETLIFY_SITE_ID_PROD }}
      
      - name: ğŸ“¢ Deployment Notification
        run: |
          echo "ğŸš€ PRODUCTION DEPLOYMENT COMPLETED!"
          echo "ğŸ”— Live URL: https://shopping-app-production.netlify.app"
          echo "ğŸ“ Commit: ${{ github.sha }}"
          